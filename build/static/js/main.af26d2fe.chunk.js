(this["webpackJsonphello-blockstack"]=this["webpackJsonphello-blockstack"]||[]).push([[0],{1062:function(e,t){},1064:function(e,t){},1087:function(e,t){},1189:function(e,t){},1190:function(e,t){},1216:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=1216},1247:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=1247},1658:function(e,t,a){},1659:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(408),i=a.n(s),c=a(1678),o=a(12),l=a.n(o),u=a(62),h=a(15),m=a(16),d=a(18),p=a(17),f=a(19),v=a(51),b=a(1679),g=a(1676),y=a(1677),O=a(28),E=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(O.Model);E.className="FriendRequest",E.schema={sender:{type:String,decrypted:!0,required:!0},recipient:{type:String,decrypted:!0,required:!0},userGroupId:{type:String,decrypted:!0,required:!0}};var k=a(1665),j=a(1666),w=a(1663),S=a(703),C=a.n(S),N=a(161),x=a.n(N),M=a(704),I=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(O.User);I.schema=Object(M.a)({},O.User.schema,{friends:{type:Array}});var P=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={person:{name:function(){return"Nudist"},avatarUrl:function(){return"/images/butt-profile.jpeg"}}},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.getProfile()}},{key:"componentDidUpdate",value:function(e){e.username!==this.props.username&&this.getProfile()}},{key:"getProfile",value:function(){var e=this,t=this.props.username;Object(v.lookupProfile)(t).then((function(t){e.setState({person:new v.Person(t)})})).catch((function(e){}))}},{key:"render",value:function(){var e=this.state.person,t=this.props.username;return r.a.createElement("div",{className:"person-top"},r.a.createElement("div",{className:"photos",style:{backgroundImage:"url(".concat(e.avatarUrl(),")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),r.a.createElement("div",null,r.a.createElement("div",{className:"person-top-name"},e.name()),r.a.createElement("div",{className:"person-top-username"},t)))}}]),t}(n.Component),U=a(1662),D=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={friendName:"Nudist",friendAvatar:"/images/butt-profile.jpeg"},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.getGroupHead()}},{key:"componentDidUpdate",value:function(e){e.group!==this.props.group&&this.getGroupHead()}},{key:"getGroupHead",value:function(){var e=this.props.group;e&&e.attrs.members[0].username===O.User.currentUser()._id?this.setState({friendName:e.attrs.members[1].username}):e&&this.setState({friendName:e.attrs.members[0].username})}},{key:"render",value:function(){var e=this.props.group;return r.a.createElement(U.a,{to:"/chat/".concat(e.attrs._id)},r.a.createElement("div",{className:"friend-item"},r.a.createElement(P,{username:this.state.friendName})))}}]),t}(n.Component),R=a(158),L=a.n(R),A=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={groups:[]},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.getMyChats()}},{key:"getMyChats",value:function(){var e,t,a,n,r,s,i,c;return l.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,l.a.awrap(L.a.myGroups());case 2:for(e=o.sent,t=[],a=!0,n=!1,r=void 0,o.prev=7,s=e[Symbol.iterator]();!(a=(i=s.next()).done);a=!0)2===(c=i.value).attrs.members.length&&t.push(c);o.next=15;break;case 11:o.prev=11,o.t0=o.catch(7),n=!0,r=o.t0;case 15:o.prev=15,o.prev=16,a||null==s.return||s.return();case 18:if(o.prev=18,!n){o.next=21;break}throw r;case 21:return o.finish(18);case 22:return o.finish(15);case 23:this.setState({groups:t});case 24:case"end":return o.stop()}}),null,this,[[7,11,15,23],[16,,18,22]])}},{key:"getFriends",value:function(){I.findOne({username:O.User.currentUser()._id})}},{key:"sendPhoto",value:function(e){console.log(e),this.props.sendPhoto(e.attrs._id)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Friend List"),r.a.createElement("div",null,r.a.createElement("ul",{className:"list-group"},this.state.groups.map((function(t){return r.a.createElement("li",{className:"list-group-item friend-list"},r.a.createElement(D,{group:t,selectChat:e.props.selectChat}),r.a.createElement("button",{className:"btn btn-light add-friend-butt",onClick:e.sendPhoto.bind(e,t)},"Send"))})))))}}]),t}(n.Component),F=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,null,[{key:"createPost",value:function(e,a){var n;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=new t({username:O.User.currentUser()._id,caption:e,base64:a}),r.next=3,l.a.awrap(n.save());case 3:return r.abrupt("return",n);case 4:case"end":return r.stop()}}))}}]),t}(O.Model);F.className="Post",F.schema={username:{type:String,decrypted:!0,required:!0},caption:{type:String,decrypted:!0,required:!0},byteArray:{type:ArrayBuffer},base64:{type:String,decrypted:!0,required:!0}},F.defaults={};var _=a(1664),G=function(){function e(){Object(h.a)(this,e)}return Object(m.a)(e,null,[{key:"b64tobinary",value:function(e){for(var t=atob(e),a=new Array(t.length),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);return new Uint8Array(a)}},{key:"toBlob",value:function(e){var t=new Blob([e],{type:"image/jpg"});return URL.createObjectURL(t)}}]),e}(),q=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={caption:""},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"post",value:function(){var e=this,t=this.props.img;F.createPost(this.state.caption,t).finally((function(){e.props.closeModal(),e.props.history.push("/")}))}},{key:"handleChange",value:function(e){this.setState({caption:e.target.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"new-post"},r.a.createElement("div",null,r.a.createElement("textarea",{placeholder:"write something juicy",value:this.state.caption,onChange:this.handleChange.bind(this)})),r.a.createElement("div",{className:"new-post-send-list"},r.a.createElement("input",{className:"form-control",placeholder:"Send as post or Slice thru DM"}),r.a.createElement("button",{className:"btn btn-light bg-salmon",onClick:this.post.bind(this),"data-toggle":"tooltip",title:"Send as post"},r.a.createElement(w.a,{color:"white"}))),r.a.createElement(A,{sendPhoto:this.props.sendPhoto}))}}]),t}(n.Component),T=Object(_.a)(q),B=a(409),z=a(707),H=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={color:"#000"},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleChangeComplete",value:function(e){this.setState({background:e.hex}),this.props.setPenColor(e.hex)}},{key:"render",value:function(){return r.a.createElement(z.HuePicker,{color:this.state.background,onChange:this.handleChangeComplete.bind(this)})}}]),t}(n.Component);x.a.setAppElement("body");var Y={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"0px"}},W=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).cam=r.a.createRef(),a._sketch=r.a.createRef(),a.state={img:null,isTakingPicture:!0,showSendOption:!1,penColor:"#000",text:"Click here to edit text"},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"takePicture",value:function(){var e=this,t=this.cam.current.getScreenshot();this.setState({img:t,isTakingPicture:!1},(function(){return e._onBackgroundImageDrop(t)}))}},{key:"sendPhoto",value:function(e){this.props.sendPhoto(this.state.img.split(",")[1],e),this.props.closeModal()}},{key:"readyToSend",value:function(){this.setState({showSendOption:!0})}},{key:"_onBackgroundImageDrop",value:function(e){this._sketch.current.setBackgroundFromDataUrl(e,{stretched:!0,stretchedX:!1,stretchedY:!1,originX:"left",originY:"top"})}},{key:"_addText",value:function(){this._sketch.current.addText(this.state.text)}},{key:"setPenColor",value:function(e){this.setState({penColor:e})}},{key:"resetPicture",value:function(){this.setState({img:null,isTakingPicture:!0,showSendOption:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement(x.a,{isOpen:this.props.modalIsOpen,onRequestClose:this.props.closeModal,style:Y,contentLabel:"Camera"},r.a.createElement("div",{className:"camera-wrap"},this.state.isTakingPicture?r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{ref:this.cam,mirrored:!0}),r.a.createElement("button",{className:"camera-button",onClick:function(){e.takePicture()}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"photo-taken"},r.a.createElement(B.SketchField,{width:"640px",height:"480px",tool:B.Tools.Pencil,lineColor:this.state.penColor,ref:this._sketch,lineWidth:3}),r.a.createElement("button",{className:"btn camera-reset",onClick:function(){e.resetPicture()}},r.a.createElement(k.a,null)),r.a.createElement("button",{className:"btn",onClick:this._addText.bind(this)},r.a.createElement(j.a,null)),r.a.createElement("button",{className:"camera-button camera-send",onClick:function(){e.readyToSend()}},r.a.createElement(w.a,{color:"rgb(231, 231, 231)"})),r.a.createElement(H,{setPenColor:this.setPenColor.bind(this)})),this.state.showSendOption&&r.a.createElement(T,{img:this.state.img,sendPhoto:this.sendPhoto.bind(this),closeModal:this.props.closeModal}))))}}]),t}(n.Component),J=a(1667),X=a(1668),K=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={img:""},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.post;return r.a.createElement("div",{className:"post-card"},r.a.createElement("div",{style:{position:"relative"}},r.a.createElement("div",{className:"post-card-name"},r.a.createElement(P,{username:e.attrs.username})),r.a.createElement("img",{src:e.attrs.base64,width:"500"})),r.a.createElement("div",null,e.attrs.caption))}}]),t}(n.Component),$=a(159),Q=a.n($),V=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={posts:[],isLoading:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0}),this.fetchPosts().finally((function(){e.setState({isLoading:!1})}))}},{key:"componentDidUpdate",value:function(e){var t=this;e.cameraModalIsOpen===this.props.cameraModalIsOpen||this.props.cameraModalIsOpen||(this.setState({isLoading:!0}),this.fetchPosts().finally((function(){t.setState({isLoading:!1})})))}},{key:"fetchPosts",value:function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(F.fetchList({sort:"-createdAt"}));case 2:e=t.sent,this.setState({posts:e});case 4:case"end":return t.stop()}}),null,this)}},{key:"render",value:function(){return r.a.createElement("div",{className:"home-feed-wrapper"},this.state.isLoading?r.a.createElement(Q.a,{type:"cylon",color:"grey",height:100,width:100}):0===this.state.posts.length?r.a.createElement("i",{style:{paddingTop:"10px"}},"No nudes posted"):this.state.posts.map((function(e){return r.a.createElement(K,{post:e})})))}}]),t}(n.Component),Z=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={cameraModalIsOpen:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){}},{key:"openCameraModal",value:function(){this.setState({cameraModalIsOpen:!0})}},{key:"closeCameraModal",value:function(){this.setState({cameraModalIsOpen:!1})}},{key:"render",value:function(){return r.a.createElement("div",{className:"home-wrapper"},r.a.createElement(V,{cameraModalIsOpen:this.state.cameraModalIsOpen}),r.a.createElement("button",{className:"btn home-hide home-button"},r.a.createElement(J.a,{size:"24"})),r.a.createElement("button",{className:"btn home-camera home-button",onClick:this.openCameraModal.bind(this)},r.a.createElement(X.a,{size:"24"})),r.a.createElement(W,{modalIsOpen:this.state.cameraModalIsOpen,closeModal:this.closeCameraModal.bind(this)}))}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={person:{name:function(){return"Anonymous"},avatarUrl:function(){return"https://s3.amazonaws.com/onename/avatar-placeholder.png"}}},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleSignOut,a=e.userSession,n=this.state.person;return a.isSignInPending()?null:r.a.createElement("div",{className:"panel-welcome",id:"section-2"},r.a.createElement("div",{className:"avatar-section",align:"center"},r.a.createElement("div",{className:"avatar",style:{backgroundImage:"url(".concat(n.avatarUrl()?n.avatarUrl():"https://s3.amazonaws.com/onename/avatar-placeholder.png",")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}})),r.a.createElement("h1",null,"Hello, ",r.a.createElement("span",{id:"heading-name"},n.name()?n.name():"Nameless Person"),"!"),r.a.createElement("p",{className:"lead"},r.a.createElement("button",{className:"btn btn-primary btn-lg",id:"signout-button",onClick:t.bind(this)},"Logout")))}},{key:"componentWillMount",value:function(){var e=this.props.userSession;this.setState({person:new v.Person(e.loadUserData().profile)})}}]),t}(n.Component),te=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.handleSignIn;return r.a.createElement("div",{className:"panel-landing"},r.a.createElement("div",{className:"panel-head"},r.a.createElement("h1",{className:"landing-heading"},"Welcome to Nuddle"),r.a.createElement("i",null,"Nuddle is a secure space where you can share your saucy photos with your mates.")),r.a.createElement("div",null,r.a.createElement("img",{src:"/images/demo.gif",width:"700px"})),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-outline-dark btn-lg",id:"signin-button",onClick:e.bind(this)},"Get Naked with Blockstack")))}}]),t}(n.Component),ae=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={input:"",searchedUsers:[]},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"onChangeHandler",value:function(e){var t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(this.setState({input:e.target.value}),""===e.target.value.trim()){a.next=7;break}return a.next=4,l.a.awrap(O.User.fetchList({username:{$regex:e.target.value}}));case 4:return t=a.sent,a.next=7,l.a.awrap(this.setState({searchedUsers:t}));case 7:case"end":return a.stop()}}),null,this)}},{key:"addFriend",value:function(e){var t,a,n;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log(e),t=new O.UserGroup({name:"FriendRequest"}),r.next=4,l.a.awrap(t.create().then((function(e){return l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))})));case 4:return r.next=6,l.a.awrap(t.makeGroupMembership(e));case 6:return a=r.sent,console.log(a),console.log(t),n=new E({sender:O.User.currentUser()._id,recipient:e,userGroupId:t._id,invitationId:a._id}),r.next=12,l.a.awrap(n.save());case 12:case"end":return r.stop()}}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"nav-link"},r.a.createElement("input",{id:"search-input",type:"text",className:"form-control friend-search",style:{fontFamily:"Arial, FontAwesome"},placeholder:"\uf002 Search for Nudist",value:this.state.input,onChange:this.onChangeHandler.bind(this)}),""!==this.state.input&&r.a.createElement("ul",{className:"list-group",id:"filterHashtag"},this.state.searchedUsers.map((function(t){return r.a.createElement("li",{className:"list-group-item seached-user-li"},r.a.createElement("div",null,t.attrs.username," "),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-light add-friend-butt",onClick:e.addFriend.bind(e,t.attrs.username)},"Add friend ",r.a.createElement("i",{class:"fas fa-plus"}))))}))))}}]),t}(n.Component),ne=a(269),re=a.n(ne),se=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={person:{name:function(){return"Anonymous"},avatarUrl:function(){return"/images/butt-profile.jpeg"},description:function(){return"No bio"}}},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"getProfile",value:function(){var e=this,t=this.props.fr;Object(v.lookupProfile)(t.attrs.sender).then((function(t){e.setState({person:new v.Person(t)})})).catch((function(e){}))}},{key:"acceptFR",value:function(){var e,t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=this.props.fr,a.next=3,l.a.awrap(re.a.findById(e.attrs.invitationId));case 3:return t=a.sent,a.next=6,l.a.awrap(t.activate());case 6:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this.props.fr;return r.a.createElement("li",{className:"list-group-item seached-user-li"},r.a.createElement("div",null,r.a.createElement("div",{className:"photos",style:{backgroundImage:"url(".concat("/images/butt-profile.jpeg",")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}})),r.a.createElement("div",null,r.a.createElement("div",null,e.attrs.sender," "),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-light add-friend-butt",onClick:this.acceptFR.bind(this)},"Accept"),r.a.createElement("button",{className:"btn btn-light add-friend-butt"},"Deny"))))}}]),t}(n.Component),ie=a(1669),ce=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={frButtonClicked:!1,friendRequests:[],isLoading:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"getFriendRequests",value:function(){var e=this;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({frButtonClicked:!this.state.frButtonClicked},(function(){var t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.state.frButtonClicked){a.next=7;break}return e.setState({isloading:!0}),a.next=4,l.a.awrap(E.fetchList({recipient:O.User.currentUser()._id},{decrypt:!0}));case 4:t=a.sent,e.setState({isloading:!1}),e.setState({friendRequests:t});case 7:case"end":return a.stop()}}))}));case 1:case"end":return t.stop()}}),null,this)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"nav-link btn",onClick:this.getFriendRequests.bind(this),"data-toggle":"tooltip",title:"Check friend requests"},r.a.createElement(ie.a,null)),this.state.frButtonClicked&&r.a.createElement("div",{className:"fr-dropdown"},this.state.isloading?r.a.createElement(Q.a,{type:"cylon",color:"white",height:100,width:100}):0===this.state.friendRequests.length?r.a.createElement("div",null,"Aw it's okay little boo if noone wanna see your nud"):r.a.createElement("ul",{className:"list-group"},this.state.friendRequests.map((function(e){return r.a.createElement(se,{fr:e})})))))}}]),t}(n.Component),oe=a(1670),le=a(1671),ue=a(1672),he=a(1673),me=a(1674),de=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={searchOpened:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"openSearch",value:function(){this.setState({searchOpened:!0})}},{key:"closeSearch",value:function(){this.setState({searchOpened:!1})}},{key:"render",value:function(){var e=this.props;e.handleSignOut,e.userSession,this.state.person;return r.a.createElement("nav",{className:"navbar navbar-expand-md bg-light justify-content-md-center justify-content-start"},r.a.createElement("a",{className:"navbar-brand d-md-none d-inline",href:""},r.a.createElement("img",{src:"/favicon.ico",width:"30",height:"30",alt:""})),r.a.createElement("button",{className:"navbar-toggler ml-1",type:"button","data-toggle":"collapse","data-target":"#collapsingNavbar2"},r.a.createElement(oe.a,{color:"#252631"})),this.state.searchOpened?r.a.createElement(ae,{closeSearch:this.closeSearch.bind(this)}):r.a.createElement("a",{className:"nav-link",onMouseEnter:this.openSearch.bind(this)},r.a.createElement(le.a,null)),r.a.createElement("div",{className:"navbar-collapse collapse justify-content-between align-items-center w-100",id:"collapsingNavbar2"},r.a.createElement("ul",{className:"navbar-nav mx-auto text-md-center text-left"},r.a.createElement("li",{className:"nav-item my-auto"},r.a.createElement(U.a,{className:"nav-link navbar-brand mx-0 d-none d-md-inline",to:"/"},"Nuddle"))),r.a.createElement("ul",{className:"nav navbar-nav flex-row justify-content-md-center justify-content-start flex-nowrap"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(ce,null)),r.a.createElement("li",{className:"nav-item"},r.a.createElement(U.a,{className:"nav-link",to:"/chat","data-toggle":"tooltip",title:"Chat"},r.a.createElement(ue.a,null))),r.a.createElement("li",{className:"nav-item","data-toggle":"tooltip",title:"Refresh feed"},r.a.createElement("a",{className:"nav-link"},r.a.createElement(he.a,null))),r.a.createElement("li",{className:"nav-item","data-toggle":"tooltip",title:"Refresh feed"},r.a.createElement("a",{className:"nav-link",onClick:this.props.handleSignOut},r.a.createElement(me.a,null))))))}}]),t}(n.Component);x.a.setAppElement("body");var pe={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",width:"500px"}},fe=(n.Component,function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={newChatModalIsOpen:!1,groups:[]},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.getMyChats()}},{key:"getMyChats",value:function(){var e,t,a,n,r,s,i,c;return l.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,l.a.awrap(O.UserGroup.myGroups());case 2:for(e=o.sent,t=[],a=!0,n=!1,r=void 0,o.prev=7,s=e[Symbol.iterator]();!(a=(i=s.next()).done);a=!0)2===(c=i.value).attrs.members.length&&t.push(c);o.next=15;break;case 11:o.prev=11,o.t0=o.catch(7),n=!0,r=o.t0;case 15:o.prev=15,o.prev=16,a||null==s.return||s.return();case 18:if(o.prev=18,!n){o.next=21;break}throw r;case 21:return o.finish(18);case 22:return o.finish(15);case 23:this.setState({groups:t});case 24:case"end":return o.stop()}}),null,this,[[7,11,15,23],[16,,18,22]])}},{key:"openNewChatModal",value:function(){this.setState({newChatModalIsOpen:!0})}},{key:"closeNewChatModal",value:function(){this.setState({newChatModalIsOpen:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"chat-list-wrapper"},r.a.createElement("div",null,r.a.createElement("h1",null,"Chats")),r.a.createElement("div",{className:"chat-list"},0===this.state.groups.length?"You don't have any saucy convo yet. Initite some":this.state.groups.map((function(t){return r.a.createElement(D,{group:t,selectChat:e.props.selectChat})}))))}}]),t}(n.Component)),ve=a(270),be=a(1675),ge=a(710),ye=(a(1656),function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,null,[{key:"sendTextMsg",value:function(e,a){var n;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=new t({sender:O.User.currentUser()._id,content:e,type:"text",userGroupId:a}),r.next=3,l.a.awrap(n.save());case 3:return r.abrupt("return",n);case 4:case"end":return r.stop()}}))}},{key:"sendPhotoMsg",value:function(e,a){var n;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=new t({sender:O.User.currentUser()._id,byte:e,type:"photo",userGroupId:a}),r.next=3,l.a.awrap(n.save());case 3:return r.abrupt("return",n);case 4:case"end":return r.stop()}}))}},{key:"sendExpirablePhotoMsg",value:function(e,a,n){var r;return l.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return r=new t({content:e,type:"expirable-photo",duration:a,userGroupId:n}),s.next=3,l.a.awrap(r.save());case 3:case"end":return s.stop()}}))}}]),t}(O.Model));ye.className="Message",ye.schema={sender:{type:String,required:!0},content:{type:String},byte:{type:ArrayBuffer},type:{type:String,required:!0},duration:{type:Number},userGroupId:{type:String,decrypted:!0,required:!0}},ye.defaults={};a(178);var Oe=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={newComment:"",characters:1e3,showEmojiPicker:!1,cameraModalIsOpen:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){}},{key:"addEmoji",value:function(e){this.setState({newComment:this.state.newComment+e.native,characters:this.state.characters+1})}},{key:"setNewComment",value:function(e){this.state.characters<1e3&&(this.setState({newComment:e.target.value,characters:e.target.value.length}),e.target.value.length)}},{key:"sendMessage",value:function(e){var t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if("Enter"!==e.key){a.next=14;break}return e.preventDefault(),a.prev=2,a.next=5,l.a.awrap(ye.sendTextMsg(this.state.newComment,this.props.chatRoomId));case 5:return t=a.sent,a.next=8,l.a.awrap(this.props.sendMessage(t));case 8:return a.next=10,l.a.awrap(this.setState({newComment:"",characters:1e3}));case 10:a.next=14;break;case 12:a.prev=12,a.t0=a.catch(2);case 14:case"end":return a.stop()}}),null,this,[[2,12]])}},{key:"sendPhoto",value:function(e,t){var a,n;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log(t),this.props.userSession,a=G.b64tobinary(e),r.prev=3,r.next=6,l.a.awrap(ye.sendPhotoMsg(a,t));case 6:return n=r.sent,r.next=9,l.a.awrap(this.props.sendMessage(n));case 9:r.next=13;break;case 11:r.prev=11,r.t0=r.catch(3);case 13:case"end":return r.stop()}}),null,this,[[3,11]])}},{key:"handleChange",value:function(e){var t=e.target.value.substring(0,999);this.setState({newComment:t,characters:1e3-e.target.value.length})}},{key:"toggleEmojiPicker",value:function(){this.setState({showEmojiPicker:!this.state.showEmojiPicker})}},{key:"openCameraModal",value:function(){this.setState({cameraModalIsOpen:!0})}},{key:"closeCameraModal",value:function(){this.setState({cameraModalIsOpen:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("div",null,r.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:" column "}},r.a.createElement("textarea",{id:"commentInput",type:"text",className:"form-control",placeholder:"Drop a thought...",value:this.state.newComment,onChange:this.handleChange.bind(this),onKeyDown:function(t){return e.sendMessage(t)}}),r.a.createElement("div",{style:{alignSelf:"flex-end"}},r.a.createElement("small",null,this.state.characters,"/",1e3)))),r.a.createElement("div",{className:"emoji-div",style:{alignSelf:"flex-start",position:"relative"}},r.a.createElement("button",{type:"button ",className:"btn btn-emoji","data-toggle":"tooltip",title:"Insert an emoji",onClick:this.toggleEmojiPicker.bind(this),style:{paddingTop:"5px"}},r.a.createElement(be.a,{size:"24"})),r.a.createElement("button",{className:"btn btn-emoji",onClick:this.openCameraModal.bind(this)},r.a.createElement(X.a,{size:"24"})),this.state.showEmojiPicker&&r.a.createElement(ge.a,{set:"emojione",onSelect:this.addEmoji.bind(this)})),r.a.createElement(W,{modalIsOpen:this.state.cameraModalIsOpen,closeModal:this.closeCameraModal.bind(this),sendPhoto:this.sendPhoto.bind(this)}))}}]),t}(n.Component),Ee=function(){function e(){Object(h.a)(this,e)}return Object(m.a)(e,null,[{key:"convertDate",value:function(e){var t=new Date(e),a=new Date-t,n=" ago",r=Math.floor(a/1e3);if(r<=60)n=r.toString()+"s ago";else{var s=Math.floor(a/1e3/60);if(s<=60)n=s.toString()+"m ago";else{var i=Math.floor(a/1e3/3600);if(i<=24)n=i.toString(),n+=i>1?" HOURS AGO":" HOUR AGO";else{var c=Math.floor(i/24);if(c<=7)n=c.toString(),n+=c>1?" DAYS AGO":" DAY AGO";else{n=t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}}}}return n}}]),e}(),ke=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.msg;return r.a.createElement("div",{className:"msg-item"},r.a.createElement("div",{style:{padding:"0px 10px"}},r.a.createElement("div",{className:"photos",style:{backgroundImage:"url(".concat("/images/butt-profile.jpeg",")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}})),r.a.createElement("div",null,r.a.createElement("i",null,e.attrs.sender),r.a.createElement("div",{className:"msg-body"},"text"===e.attrs.type&&r.a.createElement("div",null,e.attrs.content),"photo"===e.attrs.type&&r.a.createElement("img",{src:G.toBlob(this.props.msg.attrs.byte),width:"200px"}),r.a.createElement("small",{className:"timestamp"},Ee.convertDate(e.attrs.createdAt)))))}}]),t}(n.Component),je=a(705),we=function(e){function t(e){var a;Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={messageList:[],img:"",isLoading:!1};return ye.addStreamListener(function(e){e.attrs.userGroupId===a.props.match.params.chatRoomId&&a.fetchMessages()}.bind(Object(ve.a)(a))),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.match.params.chatRoomId&&this.fetchMessages()}},{key:"startLoading",value:function(){this.setState({isLoading:!0})}},{key:"endLoading",value:function(){this.setState({isLoading:!1})}},{key:"componentDidUpdate",value:function(e){var t=this;e.match.params.chatRoomId!==this.props.match.params.chatRoomId&&this.props.match.params.chatRoomId&&(this.startLoading(),this.fetchMessages().finally((function(){return t.endLoading()})))}},{key:"fetchMessages",value:function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(ye.fetchList({userGroupId:this.props.match.params.chatRoomId}));case 2:e=t.sent,this.setState({messageList:e});case 4:case"end":return t.stop()}}),null,this)}},{key:"sendMessage",value:function(e){var t=this.state.messageList;t.push(e),this.setState({messageList:t})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"chat-room-wrapper"},r.a.createElement("div",{className:"chat-room"},this.props.match.params.chatRoomId?this.state.isLoading?r.a.createElement(Q.a,{type:"cylon",color:"grey",height:100,width:100}):0===this.state.messageList.length?r.a.createElement("i",null,"You don't have any message with this nudist. Spice it up now ;)"):this.state.messageList.map((function(t){return r.a.createElement(ke,{msg:t,userSession:e.props.userSession})})):r.a.createElement("div",null,"Select a friend to nuddle")),r.a.createElement(Oe,{userSession:this.props.userSession,sendMessage:this.sendMessage.bind(this),chatRoomId:this.props.match.params.chatRoomId}))}}]),t}(n.Component),Se=Object(je.a)(we),Ce=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={selectedFriend:null},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"selectChat",value:function(e){this.setState({selectedFriend:e})}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"chat-wrapper"},r.a.createElement(fe,{selectChat:this.selectChat.bind(this)}),r.a.createElement(Se,{userSession:this.props.userSession,selectedFriend:this.state.selectedFriend}))}}]),t}(n.Component),Ne=new v.AppConfig(["store_write","publish_data"]),xe=new v.UserSession({appConfig:Ne});Object(O.configure)({apiServer:"https://nuddle-server.herokuapp.com",userSession:xe}),v.config.logLevel="none";var Me=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={userSession:xe},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleSignIn",value:function(e){e.preventDefault(),xe.redirectToSignIn()}},{key:"handleSignOut",value:function(e){e.preventDefault(),xe.signUserOut(window.location.origin)}},{key:"render",value:function(){var e,t,a,n,s,i=this;return r.a.createElement("div",{className:"site-wrapper"},xe.isUserSignedIn()?r.a.createElement(r.a.Fragment,null,r.a.createElement(de,{userSession:xe,handleSignOut:this.handleSignOut.bind(this)}),r.a.createElement("div",{className:"inner-wrapper"},r.a.createElement(b.a,null,r.a.createElement(g.a,(e={exact:!0,path:"/"},Object(u.a)(e,"exact",!0),Object(u.a)(e,"render",(function(e){return r.a.createElement(Z,Object.assign({},e,{userSession:xe,handleSignIn:i.handleSignIn}))})),e)),r.a.createElement(g.a,(t={exact:!0,path:"/profile"},Object(u.a)(t,"exact",!0),Object(u.a)(t,"render",(function(e){return r.a.createElement(ee,Object.assign({},e,{userSession:xe,handleSignOut:i.handleSignOut.bind(i)}))})),t)),r.a.createElement(g.a,(a={exact:!0,path:"/chat"},Object(u.a)(a,"exact",!0),Object(u.a)(a,"render",(function(e){return r.a.createElement(Ce,Object.assign({},e,{userSession:xe}))})),a)),r.a.createElement(g.a,(n={exact:!0,path:"/chat/:chatRoomId"},Object(u.a)(n,"exact",!0),Object(u.a)(n,"render",(function(e){return r.a.createElement(Ce,Object.assign({},e,{userSession:xe}))})),n)),r.a.createElement(g.a,(s={exact:!0,path:"/camera"},Object(u.a)(s,"exact",!0),Object(u.a)(s,"render",(function(e){return r.a.createElement(W,e)})),s)),r.a.createElement(y.a,{to:"/"})))):r.a.createElement(te,{userSession:xe,handleSignIn:this.handleSignIn}))}},{key:"componentDidMount",value:function(){var e=this;xe.isSignInPending()&&xe.handlePendingSignIn().then((function(t){return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return window.history.replaceState({},document.title,"/"),e.setState({userData:t}),a.next=4,l.a.awrap(O.User.createWithCurrentUser());case 4:case"end":return a.stop()}}))}))}}]),t}(n.Component);a(1657),a(1658);i.a.render(r.a.createElement(c.a,null,r.a.createElement(Me,null)),document.getElementById("root"))},711:function(e,t,a){e.exports=a(1659)},728:function(e,t){},730:function(e,t){},745:function(e,t){},747:function(e,t){},906:function(e,t){}},[[711,1,2]]]);
//# sourceMappingURL=main.af26d2fe.chunk.js.map