(this["webpackJsonphello-blockstack"]=this["webpackJsonphello-blockstack"]||[]).push([[0],{1063:function(e,t){},1065:function(e,t){},1088:function(e,t){},1190:function(e,t){},1191:function(e,t){},1217:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=1217},1248:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=1248},1659:function(e,t,a){},1660:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(408),i=a.n(r),c=a(1681),o=a(10),l=a.n(o),u=a(52),m=a(13),d=a(16),h=a(18),p=a(17),g=a(19),f=a(47),v=a(1682),y=a(1679),b=a(1680),E=a(22),O=function(e){function t(){return Object(m.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),t}(E.Model);O.className="FriendRequest",O.schema={sender:{type:String,decrypted:!0,required:!0},recipient:{type:String,decrypted:!0,required:!0},userGroupId:{type:String,decrypted:!0,required:!0}};var k=a(1666),j=a(1667),w=a(1664),S=a(704),x=a.n(S),N=a(162),C=a.n(N),M=a(705),P=function(e){function t(){return Object(m.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),t}(E.User);P.schema=Object(M.a)({},E.User.schema,{friends:{type:Array}});var U=function(){function e(){Object(m.a)(this,e)}return Object(d.a)(e,null,[{key:"b64tobinary",value:function(e){for(var t=atob(e),a=new Array(t.length),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);return new Uint8Array(a)}},{key:"dataURItoBlob",value:function(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),s=new Uint8Array(n),r=0;r<t.length;r++)s[r]=t.charCodeAt(r);var i=new Blob([n],{type:a});return URL.createObjectURL(i)}},{key:"toBlob",value:function(e){var t=new Blob([e],{type:"image/jpg"});return URL.createObjectURL(t)}}]),e}(),I=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={person:{name:function(){return"Nudist"},avatarUrl:function(){return"/images/logo.jpg"}},profilelUrl:""},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getProfile()}},{key:"componentDidUpdate",value:function(e){e.username!==this.props.username&&this.getProfile()}},{key:"getProfile",value:function(){var e=this,t=this.props.username;Object(f.lookupProfile)(t).then((function(t){e.setState({person:new f.Person(t)},(function(){return e.getProfilePic()}))})).catch((function(e){}))}},{key:"getProfilePic",value:function(){var e,t=this;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:e=this.state.person,this.props.userSession,fetch(e.avatarUrl(),{method:"GET",mode:"cors"}).then((function(e){e.blob().then((function(e){return URL.createObjectURL(e)})).then((function(e){t.setState({profilelUrl:e})}))}));case 3:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this.state.person,t=this.props.username;return s.a.createElement("div",{className:"person-top"},s.a.createElement("div",{className:"photos",style:{backgroundImage:"url(".concat(this.state.profilelUrl?this.state.profilelUrl:"/images/logo.jpg",")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),s.a.createElement("div",null,s.a.createElement("div",{className:"person-top-name text-truncate"},e.name()),s.a.createElement("div",{className:"person-top-username"},t)))}}]),t}(n.Component),D=a(1663),G=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={friendName:"Nudist",friendAvatar:"/images/logo.jpg"},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getGroupHead()}},{key:"componentDidUpdate",value:function(e){e.group!==this.props.group&&this.getGroupHead()}},{key:"getGroupHead",value:function(){var e=this.props.group;e&&e.attrs.members[0].username===E.User.currentUser()._id?this.setState({friendName:e.attrs.members[1].username}):e&&this.setState({friendName:e.attrs.members[0].username})}},{key:"render",value:function(){var e=this.props.group;return s.a.createElement(D.a,{to:"/chat/".concat(e.attrs._id)},s.a.createElement("div",{className:"friend-item"},s.a.createElement(I,{username:this.state.friendName})))}}]),t}(n.Component),R=a(160),L=a.n(R),F=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={groups:[]},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getMyChats()}},{key:"getMyChats",value:function(){var e,t,a,n,s,r,i,c;return l.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,l.a.awrap(L.a.myGroups());case 2:for(e=o.sent,t=[],a=!0,n=!1,s=void 0,o.prev=7,r=e[Symbol.iterator]();!(a=(i=r.next()).done);a=!0)2===(c=i.value).attrs.members.length&&t.push(c);o.next=15;break;case 11:o.prev=11,o.t0=o.catch(7),n=!0,s=o.t0;case 15:o.prev=15,o.prev=16,a||null==r.return||r.return();case 18:if(o.prev=18,!n){o.next=21;break}throw s;case 21:return o.finish(18);case 22:return o.finish(15);case 23:this.setState({groups:t});case 24:case"end":return o.stop()}}),null,this,[[7,11,15,23],[16,,18,22]])}},{key:"getFriends",value:function(){P.findOne({username:E.User.currentUser()._id})}},{key:"sendPhoto",value:function(e){this.props.sendPhoto(e.attrs._id)}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",null,"Friend List"),s.a.createElement("div",null,s.a.createElement("ul",{className:"list-group"},this.state.groups.map((function(t){return s.a.createElement("li",{className:"list-group-item friend-list"},s.a.createElement(G,{group:t,selectChat:e.props.selectChat}),s.a.createElement("button",{className:"btn btn-light add-friend-butt",onClick:e.sendPhoto.bind(e,t)},"Send"))})))))}}]),t}(n.Component),_=function(e){function t(){return Object(m.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(d.a)(t,null,[{key:"createPost",value:function(e,a){var n;return l.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=new t({username:E.User.currentUser()._id,caption:e,address:a}),s.next=3,l.a.awrap(n.save());case 3:return s.abrupt("return",n);case 4:case"end":return s.stop()}}))}}]),t}(E.Model);_.className="Post",_.schema={caption:{type:String,decrypted:!0,required:!0},byteArray:{type:ArrayBuffer},base64:{type:String,decrypted:!0},address:{type:String,decrypted:!0}},_.defaults={};var J=a(1665),A=a(178),B=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={caption:""},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"post",value:function(){var e,t,a,n,s=this;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.props,t=e.img,a=e.userSession,n=A(),r.next=4,l.a.awrap(a.putFile("".concat(n,".json"),JSON.stringify(t),{encrypt:!1}));case 4:_.createPost(this.state.caption,n).finally((function(){s.props.closeModal(),s.props.history.push("/")}));case 5:case"end":return r.stop()}}),null,this)}},{key:"handleChange",value:function(e){this.setState({caption:e.target.value})}},{key:"render",value:function(){return s.a.createElement("div",{className:"new-post"},s.a.createElement("div",null,s.a.createElement("textarea",{placeholder:"write something juicy",value:this.state.caption,onChange:this.handleChange.bind(this)})),s.a.createElement("div",{className:"new-post-send-list"},s.a.createElement("input",{className:"form-control",placeholder:"Send as post or Slice thru DM"}),s.a.createElement("button",{className:"btn btn-light bg-salmon",onClick:this.post.bind(this),"data-toggle":"tooltip",title:"Send as post"},s.a.createElement(w.a,{color:"white"}))),s.a.createElement(F,{sendPhoto:this.props.sendPhoto}))}}]),t}(n.Component),T=Object(J.a)(B),q=a(409),H=a(708),z=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={color:"#000"},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"handleChangeComplete",value:function(e){this.setState({background:e.hex}),this.props.setPenColor(e.hex)}},{key:"render",value:function(){return s.a.createElement(H.HuePicker,{color:this.state.background,onChange:this.handleChangeComplete.bind(this)})}}]),t}(n.Component),Y=a(117),K=a.n(Y),W=a(410),X=a.n(W);C.a.setAppElement("body");var $={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",margin:"50px 0",padding:"0",cameraReady:!1,minWidth:"500px",height:"auto"}},Q={width:720,height:1280,facingMode:"user"},V=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).cam=s.a.createRef(),a._sketch=s.a.createRef(),a.state={img:null,isTakingPicture:!0,showSendOption:!1,penColor:"#000",text:"Click here to edit text",width:X()(window).width(),height:X()(window).height()},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"takePicture",value:function(){var e=this,t=this.cam.current.getScreenshot();this.setState({img:t,isTakingPicture:!1},(function(){return e._onBackgroundImageDrop(t)}))}},{key:"sendPhoto",value:function(e){this.props.sendPhoto(this.state.img.split(",")[1],e),this.props.closeModal()}},{key:"readyToSend",value:function(){var e=this._sketch.current.toDataURL();this.setState({img:e,showSendOption:!0})}},{key:"_onBackgroundImageDrop",value:function(e){this._sketch.current.setBackgroundFromDataUrl(e,{stretched:!0,stretchedX:!1,stretchedY:!1,originX:"left",originY:"top"})}},{key:"_addText",value:function(){this._sketch.current.addText(this.state.text)}},{key:"setPenColor",value:function(e){this.setState({penColor:e})}},{key:"resetPicture",value:function(){this.setState({img:null,isTakingPicture:!0,showSendOption:!1})}},{key:"onUserMedia",value:function(){this.setState({cameraReady:!0})}},{key:"closeModal",value:function(){this.setState({cameraReady:!1}),this.resetPicture(),this.props.closeModal()}},{key:"render",value:function(){var e=this;return s.a.createElement(C.a,{isOpen:this.props.modalIsOpen,onRequestClose:this.closeModal.bind(this),style:$,contentLabel:"Camera"},s.a.createElement("div",{className:"camera-wrap"},this.state.cameraReady?null:s.a.createElement("div",{className:"loading-wrapper",style:{width:"100%"}},s.a.createElement(K.a,{type:"spinningBubbles",color:"salmon",height:100,width:100}),"Getting camera ready"),this.state.isTakingPicture?s.a.createElement(s.a.Fragment,null,s.a.createElement(x.a,{ref:this.cam,mirrored:!0,onUserMedia:this.onUserMedia.bind(this),height:"500px",width:"auto",videoConstraints:Q}),s.a.createElement("button",{className:"camera-button",onClick:function(){e.takePicture()}})):s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"photo-taken"},s.a.createElement(q.SketchField,{width:"500px",height:"500px",tool:q.Tools.Pencil,lineColor:this.state.penColor,ref:this._sketch,lineWidth:3}),s.a.createElement("button",{className:"btn camera-reset",onClick:function(){e.resetPicture()}},s.a.createElement(k.a,null)),s.a.createElement("button",{className:"btn",onClick:this._addText.bind(this)},s.a.createElement(j.a,null)),s.a.createElement("button",{className:"camera-button camera-send",onClick:function(){e.readyToSend()}},s.a.createElement(w.a,{color:"rgb(231, 231, 231)"})),s.a.createElement(z,{setPenColor:this.setPenColor.bind(this)})),this.state.showSendOption&&s.a.createElement(T,{userSession:this.props.userSession,img:this.state.img,sendPhoto:this.sendPhoto.bind(this),closeModal:this.props.closeModal}))))}}]),t}(n.Component),Z=a(1668),ee=a(1669),te=a(1670),ae=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={img:""},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.post;e.attrs.base64?this.setState({img:e.attrs.base64}):this.getImgFromGaia()}},{key:"componentDidUpdate",value:function(e){var t=this.props.post;e.post!==this.props.post&&(t.attrs.base64?this.setState({img:t.attrs.base64}):this.getImgFromGaia())}},{key:"getImgFromGaia",value:function(){var e,t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=this.props.post,a.next=3,l.a.awrap(Object(f.getFile)("".concat(e.attrs.address,".json"),{decrypt:!1}));case 3:return t=a.sent,a.next=6,l.a.awrap(this.setState({img:JSON.parse(t)||""}));case 6:case"end":return a.stop()}}),null,this)}},{key:"randomHeight",value:function(){var e=[450,280,550,480,200,540,380,300,400,350];return e[Math.floor(Math.random()*e.length)]}},{key:"goToImg",value:function(e){this.props.history.push("/p/".concat(e.attrs._id))}},{key:"render",value:function(){var e=this.props.post;return s.a.createElement("div",{className:"masonry-item",onClick:this.goToImg.bind(this,e)},s.a.createElement("div",{style:{position:"relative"}},s.a.createElement("div",{className:"post-card-name"},s.a.createElement("div",null,e.attrs.caption)),s.a.createElement("img",{className:"masonry-content",src:this.state.img,alt:e.attrs.username,height:this.randomHeight()})))}}]),t}(n.Component),ne=Object(J.a)(ae),se=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={posts:[],isLoading:!1,feed:"public"},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.posts;return 0===e.length?s.a.createElement("i",{style:{paddingTop:"10px"}},"No nudes posted"):e.map((function(e){return s.a.createElement(ne,{post:e})}))}}]),t}(n.Component),re=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={posts:[],isLoading:!1,feed:"public"},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0}),this.fetchPosts().finally((function(){e.setState({isLoading:!1})}))}},{key:"componentDidUpdate",value:function(e){var t=this;e.cameraModalIsOpen===this.props.cameraModalIsOpen||this.props.cameraModalIsOpen||(this.setState({isLoading:!0}),this.fetchPosts().finally((function(){t.setState({isLoading:!1})})))}},{key:"fetchPosts",value:function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(_.fetchList({sort:"-createdAt"},{decrypt:!1}));case 2:e=t.sent,this.setState({posts:e});case 4:case"end":return t.stop()}}),null,this)}},{key:"changeFeed",value:function(e){this.setState({feed:e})}},{key:"render",value:function(){return s.a.createElement("div",{className:"home-feed-wrapper col-md-8 container"},s.a.createElement("div",{className:"d-flex justify-content-center align-items-center"},s.a.createElement("a",{className:"mr-2 link link-active feed-tab","data-toggle":"tooltip",title:"Everyone's public posts",onClick:this.changeFeed.bind(this,"public")},"Public"),s.a.createElement("a",{className:"mr-2 link-light link feed-tab","data-toggle":"tooltip",title:"Your friends' private posts",onClick:this.changeFeed.bind(this,"private")},"Private")),this.props.hidden?s.a.createElement("div",{class:"masonry-wrapper"},s.a.createElement("div",{class:"masonry"},s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy1.JPG",alt:"Dummy",width:"auto",height:"400",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy2.JPG",alt:"Dummy",height:"300",width:"auto",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy3.JPG",alt:"Dummy",width:"auto",height:"400",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy4.JPG",alt:"Dummy ",width:"auto",height:"290",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy5.JPG",alt:"Dummy ",width:"auto",height:"240",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy6.JPG",alt:"Dummy ",width:"auto",height:"440",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy7.JPG",alt:"Dummy ",width:"auto",height:"430",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy8.JPG",alt:"Dummy ",width:"auto",height:"500",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy9.JPG",alt:"Dummy ",width:"auto",height:"290",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy10.JPG",alt:"Dummy ",width:"auto",height:"450",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy11.JPG",alt:"Dummy ",width:"auto",height:"550",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy12.JPG",alt:"Dummy ",width:"auto",height:"480",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy13.JPG",alt:"Dummy ",width:"auto",height:"480",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy14.JPG",alt:"Dummy ",width:"auto",height:"480",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy15.JPG",alt:"Dummy ",width:"auto",height:"480",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy16.JPG",alt:"Dummy ",width:"auto",height:"480",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy17.JPG",alt:"Dummy ",width:"auto",height:"480",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy18.JPG",alt:"Dummy ",width:"auto",height:"480",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy19.JPG",alt:"Dummy ",width:"auto",height:"280",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy20.JPG",alt:"Dummy",width:"auto",height:"480",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy21.JPG",alt:"Dummy",width:"auto",height:"480",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy22.JPG",alt:"Dummy ",width:"auto",height:"420",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy23.JPG",alt:"Dummy",width:"auto",height:"250",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy24.JPG",alt:"Dummy",width:"auto",height:"400",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy25.JPG",alt:"Dummy",width:"auto",height:"550",class:"masonry-content"})),s.a.createElement("div",{class:"masonry-item"},s.a.createElement("img",{src:"/images/dummy/dummy26.JPG",alt:"Dummy",width:"auto",height:"300",class:"masonry-content"})))):s.a.createElement("div",{class:"masonry-wrapper"},s.a.createElement("div",{class:"masonry"},this.state.isLoading?s.a.createElement("div",{className:"loading-wrapper"},s.a.createElement(K.a,{type:"spinningBubbles",color:"salmon",height:100,width:100})):"public"===this.state.feed?s.a.createElement(se,{posts:this.state.posts}):"Private feed is in the work")))}}]),t}(n.Component),ie=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={cameraModalIsOpen:!1,hidden:!1},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"openCameraModal",value:function(){this.setState({cameraModalIsOpen:!0})}},{key:"closeCameraModal",value:function(){this.setState({cameraModalIsOpen:!1})}},{key:"onHide",value:function(){this.setState({hidden:!this.state.hidden})}},{key:"render",value:function(){var e=this.props.userSession;return s.a.createElement("div",{className:"home-wrapper container-fluid"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col"},s.a.createElement(re,{userSession:this.props.userSession,cameraModalIsOpen:this.state.cameraModalIsOpen,hidden:this.state.hidden})),this.state.hidden?s.a.createElement("button",{className:"btn home-hide home-button","data-toggle":"tooltip",title:"Show Saucy Pics",onClick:this.onHide.bind(this)},s.a.createElement(Z.a,{size:"24"})):s.a.createElement("button",{className:"btn home-hide home-button","data-toggle":"tooltip",title:"Hide Saucy Pics",onClick:this.onHide.bind(this)},s.a.createElement(ee.a,{size:"24"})),e.isUserSignedIn()&&s.a.createElement("button",{className:"btn home-camera home-button","data-toggle":"tooltip",title:"Open Camera",onClick:this.openCameraModal.bind(this)},s.a.createElement(te.a,{size:"24"})),s.a.createElement(V,{userSession:this.props.userSession,modalIsOpen:this.state.cameraModalIsOpen,closeModal:this.closeCameraModal.bind(this)})))}}]),t}(n.Component),ce=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={person:{name:function(){return"Anonymous"},avatarUrl:function(){return"/images/logo.jpg"}}},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleSignOut,a=e.userSession,n=this.state.person;return a.isSignInPending()?null:s.a.createElement("div",{className:"panel-welcome",id:"section-2"},s.a.createElement("div",{className:"avatar-section",align:"center"},s.a.createElement("div",{className:"avatar",style:{backgroundImage:"url(".concat(n.avatarUrl()?n.avatarUrl():"/images/logo.jpg",")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}})),s.a.createElement("h1",null,"Hello, ",s.a.createElement("span",{id:"heading-name"},n.name()?n.name():"Nameless Person"),"!"),s.a.createElement("p",{className:"lead"},s.a.createElement("button",{className:"btn btn-primary btn-lg",id:"signout-button",onClick:t.bind(this)},"Logout")))}},{key:"componentWillMount",value:function(){var e=this.props.userSession;this.setState({person:new f.Person(e.loadUserData().profile)})}}]),t}(n.Component),oe=function(e){function t(){return Object(m.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.handleSignIn;return s.a.createElement("div",{className:"panel-landing"},s.a.createElement("div",{className:"panel-head"},s.a.createElement("h1",{className:"landing-heading"},"Welcome to Nuddle"),s.a.createElement("i",null,"Nuddle is a secure space where you can share your saucy photos with your mates.")),s.a.createElement("div",null,s.a.createElement("img",{src:"/images/demo.gif",width:"700px"})),s.a.createElement("div",null,s.a.createElement("button",{className:"btn btn-outline-dark btn-lg",id:"signin-button",onClick:e.bind(this)},"Get Naked with Blockstack")))}}]),t}(n.Component),le=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={input:"",searchedUsers:[],friends:[]},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getMyFriends()}},{key:"onChangeHandler",value:function(e){var t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(this.setState({input:e.target.value}),""===e.target.value.trim()){a.next=7;break}return a.next=4,l.a.awrap(E.User.fetchList({username:{$regex:e.target.value}}));case 4:return t=a.sent,a.next=7,l.a.awrap(this.setState({searchedUsers:t}));case 7:case"end":return a.stop()}}),null,this)}},{key:"addFriend",value:function(e){var t,a,n,s,r,i;return l.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=new E.UserGroup({name:"FriendRequest"}),c.next=3,l.a.awrap(t.create());case 3:return a=new E.GroupMembership({userGroupId:t._id,username:E.User.currentUser()._id,signingKeyPrivateKey:t.privateKey,signingKeyId:t.attrs.signingKeyId}),c.next=6,l.a.awrap(a.save());case 6:return c.next=8,l.a.awrap(t.makeGroupMembership(e));case 8:return n=c.sent,s=new O({sender:E.User.currentUser()._id,recipient:e,userGroupId:t._id,invitationId:n._id}),c.next=12,l.a.awrap(s.save());case 12:return(r=this.state.friends).push(e),this.setState({friends:r}),c.next=17,l.a.awrap(P.findOne({username:E.User.currentUser()._id}));case 17:return(i=c.sent).update({friends:r}),c.next=21,l.a.awrap(i.save());case 21:case"end":return c.stop()}}),null,this)}},{key:"getMyFriends",value:function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(P.findOne({username:E.User.currentUser()._id}));case 2:(e=t.sent).attrs.friends&&this.setState({friends:e.attrs.friends});case 4:case"end":return t.stop()}}),null,this)}},{key:"isFriend",value:function(e){return!!this.state.friends.includes(e)}},{key:"isMe",value:function(e){return e===E.User.currentUser()._id}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"nav-link"},s.a.createElement("input",{id:"search-input",type:"text",className:"form-control friend-search",placeholder:"Search for Nudist",value:this.state.input,onChange:this.onChangeHandler.bind(this)}),""!==this.state.input&&s.a.createElement("ul",{className:"list-group m-0 p-0",id:"searchedUsers"},this.state.searchedUsers.map((function(t){return s.a.createElement("li",{className:"list-group-item m-0 p-0 seached-user-li"},s.a.createElement(I,{username:t.attrs.username}),e.isFriend(t.attrs.username)||e.isMe(t.attrs.username)?s.a.createElement("div",null):s.a.createElement("div",null,s.a.createElement("button",{className:"btn btn-light add-friend-butt",onClick:e.addFriend.bind(e,t.attrs.username)},"Add friend ",s.a.createElement("i",{class:"fas fa-plus"}))))}))))}}]),t}(n.Component),ue=a(269),me=a.n(ue),de=a(1671),he=function(){function e(){Object(m.a)(this,e)}return Object(d.a)(e,null,[{key:"convertDate",value:function(e){var t=new Date(e),a=new Date-t,n=" ago",s=Math.floor(a/1e3);if(s<=60)n=s.toString()+"s ago";else{var r=Math.floor(a/1e3/60);if(r<=60)n=r.toString()+"m ago";else{var i=Math.floor(a/1e3/3600);if(i<=24)n=i.toString(),n+=i>1?" HOURS AGO":" HOUR AGO";else{var c=Math.floor(i/24);if(c<=7)n=c.toString(),n+=c>1?" DAYS AGO":" DAY AGO";else{n=t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}}}}return n}}]),e}(),pe=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={person:{name:function(){return"Anonymous"},avatarUrl:function(){return"/images/logo.jpg"},description:function(){return"No bio"}},friends:[]},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(P.findOne({username:E.User.currentUser()._id}));case 2:(e=t.sent).attrs.friends&&this.setState({friends:e.attrs.friends});case 4:case"end":return t.stop()}}),null,this)}},{key:"getProfile",value:function(){var e=this,t=this.props.fr;Object(f.lookupProfile)(t.attrs.sender).then((function(t){e.setState({person:new f.Person(t)})})).catch((function(e){}))}},{key:"acceptFR",value:function(){var e,t,a,n;return l.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=this.props.fr,s.next=3,l.a.awrap(me.a.findById(e.attrs.invitationId));case 3:return t=s.sent,s.next=6,l.a.awrap(t.activate());case 6:return(a=this.state.friends).push(e.attrs.sender),this.setState({friends:a}),s.next=11,l.a.awrap(P.findOne({username:E.User.currentUser()._id}));case 11:return(n=s.sent).update({friends:a}),s.next=15,l.a.awrap(n.save());case 15:case"end":return s.stop()}}),null,this)}},{key:"isFriend",value:function(e){return!!this.state.friends.includes(e)}},{key:"render",value:function(){var e=this.props.fr;return s.a.createElement("li",{className:"list-group-item seached-user-li"},s.a.createElement(I,{username:e.attrs.sender}),s.a.createElement("div",null,this.isFriend(e.attrs.sender)?s.a.createElement("div",null,s.a.createElement("button",{className:"btn btn-light add-friend-butt disabled"},s.a.createElement(de.a,{color:"salmon"}))):s.a.createElement("div",null,s.a.createElement("button",{className:"btn btn-light add-friend-butt",onClick:this.acceptFR.bind(this)},"Accept")),s.a.createElement("small",null,he.convertDate(e.attrs.createdAt).toLowerCase())))}}]),t}(n.Component),ge=a(1672),fe=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={frButtonClicked:!1,friendRequests:[],isLoading:!1},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"getFriendRequests",value:function(){var e=this;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({frButtonClicked:!this.state.frButtonClicked},(function(){var t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.state.frButtonClicked){a.next=7;break}return e.setState({isloading:!0}),a.next=4,l.a.awrap(O.fetchList({recipient:E.User.currentUser()._id},{decrypt:!0}));case 4:t=a.sent,e.setState({isloading:!1}),e.setState({friendRequests:t});case 7:case"end":return a.stop()}}))}));case 1:case"end":return t.stop()}}),null,this)}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{className:"nav-link btn",onClick:this.getFriendRequests.bind(this),"data-toggle":"tooltip",title:"Check friend requests"},s.a.createElement(ge.a,null)),this.state.frButtonClicked&&s.a.createElement("div",{className:"fr-dropdown"},this.state.isloading?s.a.createElement(K.a,{type:"spinningBubbles",color:"salmon",height:100,width:100}):0===this.state.friendRequests.length?s.a.createElement("div",null,"Aw it's okay little boo if noone wanna see your nud"):s.a.createElement("ul",{className:"list-group friend-request-list"},this.state.friendRequests.map((function(e){return s.a.createElement(pe,{fr:e})})))))}}]),t}(n.Component),ve=a(1673),ye=a(1674),be=a(1675),Ee=a(1676),Oe=a(1677),ke=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={searchOpened:!1},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"openSearch",value:function(){this.setState({searchOpened:!0})}},{key:"closeSearch",value:function(){this.setState({searchOpened:!1})}},{key:"render",value:function(){var e=this.props,t=(e.handleSignOut,e.userSession);this.state.person;return s.a.createElement("nav",{className:"navbar p-3 navbar-expand-md bg-light "},t.isUserSignedIn()?s.a.createElement(I,{username:t.loadUserData().username}):s.a.createElement("div",null,s.a.createElement(D.a,{className:"btn btn-outline-dark",id:"signin-button",to:"/signin"},"Get Naked with Blockstack")),s.a.createElement(D.a,{to:"/",className:"navbar-brand d-md-none d-inline"},s.a.createElement("img",{src:"/favicon.ico"})),s.a.createElement("button",{className:"navbar-toggler ml-1",type:"button","data-toggle":"collapse","data-target":"#collapsingNavbar2"},s.a.createElement(ve.a,{color:"#252631"})),s.a.createElement("div",{className:"navbar-collapse collapse \r w-100",id:"collapsingNavbar2"},s.a.createElement("ul",{className:"nav navbar-nav col-md-5 d-flex justify-content-end align-items-center"},s.a.createElement("li",{className:"nav-item my-auto"},s.a.createElement(D.a,{className:"nav-link navbar-brand mx-0 d-none d-md-inline",to:"/"},"Nuddle"))),t.isUserSignedIn()&&s.a.createElement("ul",{className:"nav navbar-nav col-md-7  flex-nowrap"},s.a.createElement("div",{className:"d-flex col justify-content-end"},s.a.createElement("li",null,this.state.searchOpened?s.a.createElement(le,{closeSearch:this.closeSearch.bind(this)}):s.a.createElement("div",{className:"nav-link",onMouseEnter:this.openSearch.bind(this)},s.a.createElement(ye.a,null))),s.a.createElement("li",{className:"nav-item","data-toggle":"tooltip",title:"Friend Requests"},s.a.createElement(fe,null))),s.a.createElement("div",{className:"d-flex col-md-6 justify-content-between align-items-center"},s.a.createElement("div",{className:"d-flex"},s.a.createElement("li",{className:"nav-item"},s.a.createElement(D.a,{className:"nav-link",to:"/chat","data-toggle":"tooltip",title:"Chat"},s.a.createElement(be.a,null))),s.a.createElement("li",{className:"nav-item","data-toggle":"tooltip",title:"Refresh feed"},s.a.createElement(D.a,{to:"/",className:"nav-link"},s.a.createElement(Ee.a,null))),s.a.createElement("li",{className:"nav-item","data-toggle":"tooltip",title:"Log Out"},s.a.createElement("a",{className:"nav-link",onClick:this.props.handleSignOut},s.a.createElement(Oe.a,null))))))))}}]),t}(n.Component);C.a.setAppElement("body");var je={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",width:"500px"}},we=(n.Component,function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={newChatModalIsOpen:!1,groups:[]},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getMyChats()}},{key:"getMyChats",value:function(){var e,t,a,n,s,r,i,c;return l.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,l.a.awrap(E.UserGroup.myGroups());case 2:for(e=o.sent,t=[],a=!0,n=!1,s=void 0,o.prev=7,r=e[Symbol.iterator]();!(a=(i=r.next()).done);a=!0)2===(c=i.value).attrs.members.length&&t.push(c);o.next=15;break;case 11:o.prev=11,o.t0=o.catch(7),n=!0,s=o.t0;case 15:o.prev=15,o.prev=16,a||null==r.return||r.return();case 18:if(o.prev=18,!n){o.next=21;break}throw s;case 21:return o.finish(18);case 22:return o.finish(15);case 23:this.setState({groups:t});case 24:case"end":return o.stop()}}),null,this,[[7,11,15,23],[16,,18,22]])}},{key:"openNewChatModal",value:function(){this.setState({newChatModalIsOpen:!0})}},{key:"closeNewChatModal",value:function(){this.setState({newChatModalIsOpen:!1})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"chat-list-wrapper"},s.a.createElement("div",null,s.a.createElement("h1",null,"Chats")),s.a.createElement("div",{className:"chat-list"},0===this.state.groups.length?"You don't have any saucy convo yet. Initite some":this.state.groups.map((function(t){return s.a.createElement(G,{group:t,selectChat:e.props.selectChat})}))))}}]),t}(n.Component)),Se=a(270),xe=a(1678),Ne=a(711),Ce=(a(1657),function(e){function t(){return Object(m.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(d.a)(t,null,[{key:"sendTextMsg",value:function(e,a){var n;return l.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=new t({sender:E.User.currentUser()._id,content:e,type:"text",userGroupId:a}),s.next=3,l.a.awrap(n.save());case 3:return s.abrupt("return",n);case 4:case"end":return s.stop()}}))}},{key:"sendPhotoMsg",value:function(e,a){var n;return l.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=new t({sender:E.User.currentUser()._id,byte:e,type:"photo",userGroupId:a}),s.next=3,l.a.awrap(n.save());case 3:return s.abrupt("return",n);case 4:case"end":return s.stop()}}))}},{key:"sendExpirablePhotoMsg",value:function(e,a,n){var s;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return s=new t({content:e,type:"expirable-photo",duration:a,userGroupId:n}),r.next=3,l.a.awrap(s.save());case 3:case"end":return r.stop()}}))}}]),t}(E.Model));Ce.className="Message",Ce.schema={sender:{type:String,required:!0},content:{type:String},byte:{type:ArrayBuffer},type:{type:String,required:!0},duration:{type:Number},userGroupId:{type:String,decrypted:!0,required:!0}},Ce.defaults={};var Me=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={newComment:"",characters:1e3,showEmojiPicker:!1,cameraModalIsOpen:!1},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"addEmoji",value:function(e){this.setState({newComment:this.state.newComment+e.native,characters:this.state.characters+1})}},{key:"setNewComment",value:function(e){this.state.characters<1e3&&(this.setState({newComment:e.target.value,characters:e.target.value.length}),e.target.value.length)}},{key:"sendMessage",value:function(e){var t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if("Enter"!==e.key){a.next=14;break}return e.preventDefault(),a.prev=2,a.next=5,l.a.awrap(Ce.sendTextMsg(this.state.newComment,this.props.chatRoomId));case 5:return t=a.sent,a.next=8,l.a.awrap(this.props.sendMessage(t));case 8:return a.next=10,l.a.awrap(this.setState({newComment:"",characters:1e3}));case 10:a.next=14;break;case 12:a.prev=12,a.t0=a.catch(2);case 14:case"end":return a.stop()}}),null,this,[[2,12]])}},{key:"sendPhoto",value:function(e,t){var a,n;return l.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return this.props.userSession,a=U.b64tobinary(e),s.prev=2,s.next=5,l.a.awrap(Ce.sendPhotoMsg(a,t));case 5:return n=s.sent,s.next=8,l.a.awrap(this.props.sendMessage(n));case 8:s.next=12;break;case 10:s.prev=10,s.t0=s.catch(2);case 12:case"end":return s.stop()}}),null,this,[[2,10]])}},{key:"handleChange",value:function(e){var t=e.target.value.substring(0,999);this.setState({newComment:t,characters:1e3-e.target.value.length})}},{key:"toggleEmojiPicker",value:function(){this.setState({showEmojiPicker:!this.state.showEmojiPicker})}},{key:"openCameraModal",value:function(){this.setState({cameraModalIsOpen:!0})}},{key:"closeCameraModal",value:function(){this.setState({cameraModalIsOpen:!1})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"input-wrapper"},s.a.createElement("div",null,s.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:" column "}},s.a.createElement("textarea",{id:"commentInput",type:"text",className:"form-control",placeholder:"Drop a thought...",value:this.state.newComment,onChange:this.handleChange.bind(this),onKeyDown:function(t){return e.sendMessage(t)}}),s.a.createElement("div",{style:{alignSelf:"flex-end"}},s.a.createElement("small",null,this.state.characters,"/",1e3)))),s.a.createElement("div",{className:"emoji-div",style:{alignSelf:"flex-start",position:"relative"}},s.a.createElement("button",{type:"button ",className:"btn btn-emoji","data-toggle":"tooltip",title:"Insert an emoji",onClick:this.toggleEmojiPicker.bind(this),style:{paddingTop:"5px"}},s.a.createElement(xe.a,{size:"24"})),s.a.createElement("button",{className:"btn btn-emoji",onClick:this.openCameraModal.bind(this)},s.a.createElement(te.a,{size:"24"})),this.state.showEmojiPicker&&s.a.createElement(Ne.a,{set:"emojione",onSelect:this.addEmoji.bind(this)})),s.a.createElement(V,{userSession:this.props.userSession,modalIsOpen:this.state.cameraModalIsOpen,closeModal:this.closeCameraModal.bind(this),sendPhoto:this.sendPhoto.bind(this)}))}}]),t}(n.Component),Pe=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"isMyMsg",value:function(e){return e===E.User.currentUser()._id}},{key:"render",value:function(){var e=this.props.msg;return s.a.createElement("div",{className:"msg-item-wrapper"},s.a.createElement("div",{className:"msg-item "+(this.isMyMsg(e.attrs.sender)?"my-msg":"")},s.a.createElement("div",{style:{padding:"0px 10px"}},s.a.createElement("div",{className:"photos",style:{backgroundImage:"url(".concat("/images/logo.jpg",")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}})),s.a.createElement("div",null,s.a.createElement("i",null,e.attrs.sender),s.a.createElement("div",{className:"msg-body"},"text"===e.attrs.type&&s.a.createElement("div",null,e.attrs.content),"photo"===e.attrs.type&&s.a.createElement("img",{src:U.toBlob(this.props.msg.attrs.byte),width:"200px"}),s.a.createElement("small",{className:"timestamp"},he.convertDate(e.attrs.createdAt))))))}}]),t}(n.Component),Ue=a(706),Ie=function(e){function t(e){var a;Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={messageList:[],img:"",isLoading:!1};return Ce.addStreamListener(function(e){e.attrs.userGroupId===a.props.match.params.chatRoomId&&a.fetchMessages()}.bind(Object(Se.a)(a))),a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.match.params.chatRoomId&&this.fetchMessages()}},{key:"startLoading",value:function(){this.setState({isLoading:!0})}},{key:"endLoading",value:function(){this.setState({isLoading:!1})}},{key:"componentDidUpdate",value:function(e){var t=this;e.match.params.chatRoomId!==this.props.match.params.chatRoomId&&this.props.match.params.chatRoomId&&(this.startLoading(),this.fetchMessages().finally((function(){return t.endLoading()})))}},{key:"fetchMessages",value:function(){var e;return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(Ce.fetchList({userGroupId:this.props.match.params.chatRoomId}));case 2:e=t.sent,this.setState({messageList:e});case 4:case"end":return t.stop()}}),null,this)}},{key:"sendMessage",value:function(e){var t=this.state.messageList;t.push(e),this.setState({messageList:t})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"chat-room-wrapper"},s.a.createElement("div",{className:"chat-room"},this.props.match.params.chatRoomId?this.state.isLoading?s.a.createElement(K.a,{type:"spinningBubbles",color:"salmon",height:100,width:100}):0===this.state.messageList.length?s.a.createElement("i",null,"You don't have any message with this nudist. Spice it up now ;)"):this.state.messageList.map((function(t){return s.a.createElement(Pe,{msg:t,userSession:e.props.userSession})})):s.a.createElement("div",null,"Select a friend to nuddle")),s.a.createElement(Me,{userSession:this.props.userSession,sendMessage:this.sendMessage.bind(this),chatRoomId:this.props.match.params.chatRoomId}))}}]),t}(n.Component),De=Object(Ue.a)(Ie),Ge=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={selectedFriend:null},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"selectChat",value:function(e){this.setState({selectedFriend:e})}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return s.a.createElement("div",{className:"chat-wrapper"},s.a.createElement(we,{selectChat:this.selectChat.bind(this)}),s.a.createElement(De,{userSession:this.props.userSession,selectedFriend:this.state.selectedFriend}))}}]),t}(n.Component),Re=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={post:{attrs:{username:"Nudist",base64:""}},img:""},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.match.params.postId?this.getPost():this.props.history.push("/")}},{key:"getPost",value:function(){var e,t,a=this;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.props.match.params.postId,n.next=3,l.a.awrap(_.findOne({_id:e},{decrypt:!1}));case 3:(t=n.sent)?this.setState({post:t},(function(){a.state.post.attrs.base64?a.setState({img:a.state.post.attrs.base64}):a.getImgFromGaia()})):this.props.history.push("/");case 5:case"end":return n.stop()}}),null,this)}},{key:"getImgFromGaia",value:function(){var e,t,a;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.state.post,t=this.props.userSession,n.next=4,l.a.awrap(t.getFile("".concat(e.attrs.address,".json"),{decrypt:!1}));case 4:return a=n.sent,n.next=7,l.a.awrap(this.setState({img:JSON.parse(a)||""}));case 7:case"end":return n.stop()}}),null,this)}},{key:"render",value:function(){var e=this.state,t=e.post,a=e.img;return s.a.createElement("div",{className:"single-post-wrapper"},s.a.createElement("div",null,s.a.createElement("img",{src:a}),s.a.createElement("p",null,t.attrs.caption)))}}]),t}(n.Component),Le=new f.AppConfig(["store_write","publish_data"]),Fe=new f.UserSession({appConfig:Le});Object(E.configure)({apiServer:"https://nuddle-server.herokuapp.com",userSession:Fe}),f.config.logLevel="none";var _e=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={userSession:Fe},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"handleSignIn",value:function(e){e.preventDefault(),Fe.redirectToSignIn()}},{key:"handleSignOut",value:function(e){e.preventDefault(),Fe.signUserOut(window.location.origin)}},{key:"render",value:function(){var e,t,a,n,r,i,c=this;return s.a.createElement("div",{className:"site-wrapper"},Fe.isUserSignedIn()?s.a.createElement(s.a.Fragment,null,s.a.createElement(ke,{userSession:Fe,handleSignOut:this.handleSignOut.bind(this)}),s.a.createElement("div",{className:"inner-wrapper"},s.a.createElement(v.a,null,s.a.createElement(y.a,(e={exact:!0,path:"/"},Object(u.a)(e,"exact",!0),Object(u.a)(e,"render",(function(e){return s.a.createElement(ie,Object.assign({},e,{userSession:Fe,handleSignIn:c.handleSignIn}))})),e)),s.a.createElement(y.a,(t={exact:!0,path:"/profile"},Object(u.a)(t,"exact",!0),Object(u.a)(t,"render",(function(e){return s.a.createElement(ce,Object.assign({},e,{userSession:Fe,handleSignOut:c.handleSignOut.bind(c)}))})),t)),s.a.createElement(y.a,(a={exact:!0,path:"/chat"},Object(u.a)(a,"exact",!0),Object(u.a)(a,"render",(function(e){return s.a.createElement(Ge,Object.assign({},e,{userSession:Fe}))})),a)),s.a.createElement(y.a,(n={exact:!0,path:"/chat/:chatRoomId"},Object(u.a)(n,"exact",!0),Object(u.a)(n,"render",(function(e){return s.a.createElement(Ge,Object.assign({},e,{userSession:Fe}))})),n)),s.a.createElement(y.a,(r={exact:!0,path:"/camera"},Object(u.a)(r,"exact",!0),Object(u.a)(r,"render",(function(e){return s.a.createElement(V,e)})),r)),s.a.createElement(y.a,(i={exact:!0,path:"/p/:postId"},Object(u.a)(i,"exact",!0),Object(u.a)(i,"render",(function(e){return s.a.createElement(Re,Object.assign({},e,{userSession:Fe}))})),i)),s.a.createElement(b.a,{to:"/"})))):s.a.createElement(oe,{userSession:Fe,handleSignIn:this.handleSignIn}))}},{key:"componentDidMount",value:function(){var e=this;Fe.isSignInPending()&&Fe.handlePendingSignIn().then((function(t){return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return window.history.replaceState({},document.title,"/"),e.setState({userData:t}),a.next=4,l.a.awrap(E.User.createWithCurrentUser());case 4:case"end":return a.stop()}}))}))}}]),t}(n.Component);a(1658),a(1659);i.a.render(s.a.createElement(c.a,null,s.a.createElement(_e,null)),document.getElementById("root"))},712:function(e,t,a){e.exports=a(1660)},729:function(e,t){},731:function(e,t){},746:function(e,t){},748:function(e,t){},907:function(e,t){}},[[712,1,2]]]);
//# sourceMappingURL=main.9c74a830.chunk.js.map